# Интеграция Actor Framework в агентную систему

## Обзор изменений

В рамках улучшения архитектуры проекта была реализована кастомная система акторов для изоляции выполнения инструментов и улучшения масштабируемости.

## Архитектурные изменения

### До рефакторинга
- MainAgent напрямую вызывал инструменты (command_executor, web_search_executor)
- Отсутствовала изоляция выполнения инструментов
- Нарушение принципов Actor System

### После рефакторинга
- MainAgent заменен на ActorAgent, который наследуется от Actor и BaseAgent
- Инструменты выполняются через специализированные акторы (CommandActor, WebSearchActor)
- Каждый инструмент работает в изолированной среде
- Поддержка динамического создания подчиненных акторов

## Компоненты Actor Framework

### Core Components
- `ActorSystem` - глобальная система управления акторами
- `Actor` - абстрактный базовый класс для всех акторов
- `ActorMessage` - сообщения для межакторного взаимодействия
- `ActorAgent` - агент, реализованный с использованием Actor Framework

### Tool Actors
- `CommandActor` - выполнение shell-команд с безопасностью
- `WebSearchActor` - веб-поиск через DuckDuckGo

## Преимущества новой архитектуры

1. **Изоляция выполнения** - ошибки в одном инструменте не влияют на другие
2. **Масштабируемость** - возможность параллельного выполнения нескольких инструментов
3. **Управляемость** - лучший контроль за жизненным циклом инструментов
4. **Соответствие принципам** - реализация Actor System как требовалось

## Пример использования

```python
# В агенте создается подчиненный актор для выполнения команды
command_actor = CommandActor(
    safety_agent=self.safety_agent,
    executor=self.command_executor
)
await self.spawn_child(command_actor)

# Отправка сообщения актору
result = await command_actor.ask(ActorMessage(
    recipient=command_actor.actor_id,
    payload=ExecuteCommand(command="ls -la"),
    message_type=MessageType.EXECUTE_COMMAND
))
```

## Тестирование

Созданы тесты для проверки функциональности:
- `tests/test_actors/test_actor_system.py` - основные функции системы акторов
- `tests/test_actors/test_command_actor.py` - тестирование CommandActor

## Потенциальные улучшения

1. Добавить стратегии восстановления после ошибок (supervision)
2. Реализовать таймауты для сообщений между акторами
3. Добавить более сложные схемы маршрутизации сообщений
4. Реализовать persistence для сообщений акторов